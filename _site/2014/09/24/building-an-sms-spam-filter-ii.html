<!DOCTYPE html>
<html lang="en">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@kehers">
  <meta name="twitter:title" content="Building an SMS spam filter II">
  <meta name="twitter:description" content="I started an experiment on spam filtering for SMS the other week. I called it Snag. You can read about it here already: https://kehers.github.com/2014/09/07/building-an-sms-spam-filter.html.

The w...">
  <meta name="twitter:creator" content="@kehers">
  <title>Building an SMS spam filter II</title>
  <link href='https://fonts.googleapis.com/css?family=Libre+Baskerville:400,700' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Muli' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="/assets/css/normalize.css">
  <link rel="stylesheet" href="/assets/css/skeleton.css">
  <link rel="stylesheet" href="/assets/css/custom.css">
  <link rel="stylesheet" href="/assets/css/zenburn.css" />
  <link rel="alternate" type="application/atom+xml" title="Blog post feed" href="/feed.xml">
</head>
<body>

<div class="container">
  <header>
    <div class="row">
      <div id="logo" class="three columns">
      <div id="menu">☰</div>
      <h3><a href="/">/opeyemi</a></h3>
    </div>
      <nav class="nine columns">
        <ul>
          <li><a href="/">Home</a></li>
          <li><a href="/posts.html">Posts</a></li>
          <li><a href="/feed.xml">RSS Feed</a></li>
          <li><a href="http://gum.co/Sxoj" class="bordered">Consuming REST APIs - a soft introduction</a></li>
      </ul>
      </nav>
    </div>
  </header>
  <div class="row">
    <div class="six offset-by-three columns">
      <article>
        <date>24 Sep 2014</date>
        <h1 class="title">Building an SMS spam filter II</h1>
        <p>I started an experiment on spam filtering for SMS the other week. I called it <strong>Snag</strong>. You can read about it here already: <a href="https://kehers.github.com/2014/09/07/building-an-sms-spam-filter.html">https://kehers.github.com/2014/09/07/building-an-sms-spam-filter.html</a>.</p>

<p>The way Snag should work is</p>

<ol>
  <li>Intercept incoming SMS</li>
  <li>Match against trained data</li>
  <li>If spam, save in a separate db and block from reaching the phone’s message inbox (or any other message app)</li>
</ol>

<p>1 and 2 work already. 3 works on Android versions below 4.4. From Android 4.4 (Kitkat), you can no longer block SMS from other messaging apps. <a href="http://android-developers.blogspot.com/2013/10/getting-your-sms-apps-ready-for-kitkat.html">More details about this here</a>. In other words, while Snag will intercept an incoming message and detect if it is spam or not, it won’t be able to stop it from reaching the phone’s inbox in Android versions from 4.4. The workaround is to develop a full SMS application. Unfortunately, that is a time I don’t have now so I have to halt development and opensource it. You can find it on Github here: <a href="http://github.com/kehers/snag-android">http://github.com/kehers/snag-android</a></p>

<h2 id="what-good-is-that-then">What good is that then?</h2>
<p>If you are interested in finishing it for &lt; 4.4, the source is a good headstart for you. I have done some views, the interception and spam detection work already. The only things left to do are:</p>

<ol>
  <li>Create the single message view. (The list view for all messages done)</li>
  <li>Allow users add a message to the training data (using the + icon)</li>
  <li>Let users delete and “un-spam” a message</li>
  <li>Add boring static content - about, feedback, rate</li>
</ol>

<p>Another thing you can use this for is to create an app that listens to incoming messages to perform an action - OTP verification for example. Just strip away the spam classification part and use the SMSListener part.</p>

<h2 id="db-schema">DB Schema</h2>
<p>Snag contains an existing database of words based on spam data from <a href="https://docs.google.com/document/d/1TldaHwtLwuAq8paUyjLLUuJqthjYvymOMk5Op8gtR4Y/edit">https://docs.google.com/document/d/1TldaHwtLwuAq8paUyjLLUuJqthjYvymOMk5Op8gtR4Y/edit</a> and non-spam from my phone. The <code class="highlighter-rouge">words</code> table contains the columns <code class="highlighter-rouge">word</code>, <code class="highlighter-rouge">ham_count</code> and <code class="highlighter-rouge">spam_count</code>. There is also a <code class="highlighter-rouge">likely_spam</code> table where detected spam messages are stored. It has the columns <code class="highlighter-rouge">id</code>, <code class="highlighter-rouge">sender_id</code>, <code class="highlighter-rouge">body</code> and <code class="highlighter-rouge">date</code>.</p>

<p>You will find the database in <code class="highlighter-rouge">/assets/snag.db</code>. It includes the training data. If you don’t have an SQLite client and you run on Firefox, you can download the <a href="https://addons.mozilla.org/en-US/firefox/addon/sqlite-manager/">SQLite Manager addon</a> to explore the data.</p>

<p>If you need to ask me anything, even non-related to the project, be free to send me a mail on kehers@gmail.com or to <a href="https://twitter.com/kehers">@kehers</a> on twitter.</p>

      </article>
    </div>
  </div>
</div>
<div class="colophon">
  <div class="container">
    <div class="row">
      <div class="author six offset-by-three columns">
        <img src="https://igcdn-photos-f-a.akamaihd.net/hphotos-ak-xfp1/t51.2885-15/e15/10617063_553407278119581_1973098870_n.jpg" class="avi"> <p>My name is Opeyemi Obembe. I build things for web and mobile. You should follow me on Twitter (<a href="http://twitter.com/kehers">@kehers</a>).</p>
      </div>
    </div>
    <div class="row p-t-20">
      <div class="six offset-by-three columns">
        
        
        
        <article class="m-t-20">
          <h4 class="title m-b-20">Next post</h4>
          <h5 class="libre no-margin"><a href="/2014/09/18/why-github-pages-for-blogging.html">Why Github pages for blogging?</a></h5>
        </article>
        
        <h4 class="title">Comments</h4>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
          var disqus_shortname = 'kehers';
          (function() {
              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
              (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
        </script>
      </div>
    </div>
  </div>
</div>

<footer>
  <div class="container">
    <div class="row">
      <div class="three offset-by-three columns">
        <a href="/">/opeyemi</a> · <a href="http://github.com/kehers/kehers.github.com">Source</a> · <a href="/feed.xml">RSS feed</a>
      </div>
      <div class="three columns">
        <a href="http://twitter.com/kehers">Twitter</a> · <a href="http://github.com/kehers">Github</a> · <a href="http://instagram.com/kehers">Instagram</a> · <a href="http://500px.com/kehers">500px</a>
    </div>
    </div>
  </div>
</footer>

<script type="text/javascript" src="/assets/js/menu.js"></script>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-53373832-1', 'auto');
ga('send', 'pageview');
</script>

</body>
</html>